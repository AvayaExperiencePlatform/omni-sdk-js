<!DOCTYPE html><html class="default" lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>@avaya/axp-client-sdk-messaging | AXP Web Omni SDK</title><meta name="description" content="Documentation for AXP Web Omni SDK"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="../assets/style.css"/><link rel="stylesheet" href="../assets/highlight.css"/><script defer src="../assets/main.js"></script><script async src="../assets/icons.js" id="tsd-icons-script"></script><script async src="../assets/search.js" id="tsd-search-script"></script><script async src="../assets/navigation.js" id="tsd-nav-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><div class="table-cell" id="tsd-search" data-base=".."><div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><use href="../assets/icons.svg#icon-search"></use></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div><div class="field"><div id="tsd-toolbar-links"></div></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="../index.html" class="title">AXP Web Omni SDK</a></div><div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><use href="../assets/icons.svg#icon-menu"></use></svg></a></div></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><ul class="tsd-breadcrumb"><li><a href="../index.html">AXP Web Omni SDK</a></li><li><a href="_avaya_axp_client_sdk_messaging.html">@avaya/axp-client-sdk-messaging</a></li></ul><h1>Module @avaya/axp-client-sdk-messaging</h1></div><section class="tsd-panel tsd-typography"><a id="md:axp-messaging" class="tsd-anchor"></a><h1><a href="#md:axp-messaging">AXP Messaging</a></h1><p>The AXP Messaging SDK module provides enables asynchronous communication, allowing end users to resume conversation threads at any time and view all previous messages exchanged as part of the conversation. This is unlike a session-based chat, where the chat is closed after the participants disconnect the dialog. The AXP Messaging module extends base Conversation with Messaging capabilities.</p>
<p>The AXP Messaging module depends on the AXP Core module. Please refer to the <a href="/modules/_avaya_axp_client_sdk_core">AXP Core documentation</a> before using the Messaging module.</p>
<a id="md:main-features" class="tsd-anchor"></a><h2><a href="#md:main-features">Main features</a></h2><ol>
<li><strong>Message History</strong>: The AXP Messaging module provides a message history feature that allows users to view all messages exchanged in a conversation thread.</li>
<li><strong>Resume Conversation</strong>: The AXP Messaging module allows users to resume a messaging conversation thread at any time.</li>
<li><strong>Send Message</strong>: The AXP Messaging module allows users to send messages to other participants in a conversation thread.</li>
<li><strong>Receive Message</strong>: The AXP Messaging module allows users to receive messages from other participants in a conversation thread.</li>
<li><strong>Send rich media messages</strong>: The AXP Messaging module allows users to send rich media messages like Post back, replies and location to other participants in a conversation thread.</li>
<li><strong>Receive rich media messages</strong>: The AXP Messaging module allows users to receive rich media messages like Post back, Replies and Location Request, Carousel etc, from other participants in a conversation thread.</li>
<li><strong>Send and receive attachments</strong>: The AXP Messaging module allows users to send and receive attachments like images, videos, audio, documents etc, to other participants in a conversation thread.</li>
</ol>
<a id="md:installation" class="tsd-anchor"></a><h2><a href="#md:installation">Installation</a></h2><p>AXP Messaging module requires the AXP Core module.</p>
<p>To install the AXP Messaging module, install the AXP Messaging module using the following command:</p>
<pre><code class="language-bash"><span class="hl-0">npm</span><span class="hl-1"> </span><span class="hl-2">install</span><span class="hl-1"> </span><span class="hl-2">@avaya/axp-client-sdk-messaging</span>
</code><button>Copy</button></pre>
<p>This will install both AXP Core and AXP Messaging.</p>
<a id="md:usage" class="tsd-anchor"></a><h2><a href="#md:usage">Usage</a></h2><p>The AXP Messaging module provides the <code>AxpMessagingConversation</code> <a href="https://www.typescriptlang.org/docs/handbook/mixins.html">mixin</a> that extends the Base Conversation of the AXP Core module. To use the Messaging module, you need to import the <code>AxpMessagingConversation</code> mixin function and apply it. Check out more details about additional functionalities in the <a href="/modules/_avaya_axp_client_sdk_core#using-additional-functionalities">Using additional functionality</a> section of The AXP Core&#39;s documentation.</p>
<p>Example of how to use AXP Messaging module:</p>
<pre><code class="language-ts"><span class="hl-7">// Note: Here ... (dot dot dot) indicates the rest of the code, which is excluded for brevity.</span><br/><br/><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">AxpClientSdk</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&#39;@avaya/axp-client-sdk-core&#39;</span><span class="hl-1">;</span><br/><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">AxpMessagingConversation</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&#39;@avaya/axp-client-sdk-messaging&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">EnhancedConversationClass</span><span class="hl-1"> = </span><span class="hl-0">AxpMessagingConversation</span><span class="hl-1">();</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">userSession</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">AxpClientSdk</span><span class="hl-1">.</span><span class="hl-0">init</span><span class="hl-1">({...}, </span><span class="hl-4">EnhancedConversationClass</span><span class="hl-1">);</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">defaultConversation</span><span class="hl-1"> = </span><span class="hl-4">userSession</span><span class="hl-1">.</span><span class="hl-4">conversations</span><span class="hl-1">[</span><span class="hl-9">0</span><span class="hl-1">];</span><br/><br/><span class="hl-7">// The `defaultConversation` object has methods of both AXP Core and Messaging modules.</span><br/><span class="hl-4">defaultConversation</span><span class="hl-1">.</span><span class="hl-0">addParticipantAddedListener</span><span class="hl-1">(...) </span><span class="hl-7">// &lt;-- AXP Core method</span><br/><span class="hl-4">defaultConversation</span><span class="hl-1">.</span><span class="hl-0">sendMessage</span><span class="hl-1">(...); </span><span class="hl-7">// &lt;-- AXP Messaging method</span>
</code><button>Copy</button></pre>
<a id="md:messaging-conversation" class="tsd-anchor"></a><h2><a href="#md:messaging-conversation">Messaging Conversation</a></h2><p>Messaging Conversation provides APIs to send and receive rich media and attachment messages, get conversation history and listen to message events. For more details on the APIs exposed on the Messaging Conversation, refer to the <code>{@link AxpMessagingConversationTrait}</code> interface.</p>
<a id="md:getting-conversation-history" class="tsd-anchor"></a><h3><a href="#md:getting-conversation-history">Getting conversation history</a></h3><p>To get the conversation history, use the <code>getMessages()</code> method on the Conversation. The <code>getMessages()</code> method returns a <code>PageIterator</code> object that can be used to iterate over the messages in the conversation. The <code>getMessages()</code> API takes an optional parameter <code>pageSize</code> which specifies the number of messages to fetch in a single page. The default value of <code>pageSize</code> is 10 and maximum page size is 50.</p>
<p>Note: The iterator can only be used to get messages conversed in the conversation from start up until the point the iterator was created. For newer messages please listen to the message events. Do not use the <code>getMessages()</code> API to get new messages.</p>
<p>Each Page of the iterator contains a list of messages. As the page number increases, the messages are older. The iterator can be used to get messages in both directions (forward and backward).</p>
<p>The <code>PageIterator.previous()</code> and <code>PageIterator.next()</code> are async methods, when called they fetch the previous and next page of messages respectively and each resolves with an Array of <code>Message</code>. The <code>PageIterator.hasNext()</code> and <code>PageIterator.hasPrevious()</code> methods check if there are more messages in the next and previous pages, respectively.  </p>
<p>At any point <code>PageIterator.items</code> can be used to get the messages on the current page.</p>
<pre><code class="language-ts"><span class="hl-5">function</span><span class="hl-1"> </span><span class="hl-0">showMessagesOnUI</span><span class="hl-1">(</span><span class="hl-4">messages</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-7">// Logic to show messages on UI.</span><br/><span class="hl-1">    </span><span class="hl-7">// ...</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">iterator</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">conversation</span><span class="hl-1">.</span><span class="hl-0">getMessages</span><span class="hl-1">(</span><span class="hl-9">15</span><span class="hl-1">);</span><br/><br/><span class="hl-0">showMessagesOnUI</span><span class="hl-1">(</span><span class="hl-4">iterator</span><span class="hl-1">.</span><span class="hl-4">items</span><span class="hl-1">);</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">loadMore</span><span class="hl-1"> = </span><span class="hl-4">document</span><span class="hl-1">.</span><span class="hl-0">getElementById</span><span class="hl-1">(</span><span class="hl-2">&#39;load-more-button&#39;</span><span class="hl-1">);</span><br/><br/><span class="hl-4">loadMore</span><span class="hl-1">.</span><span class="hl-0">onclick</span><span class="hl-1"> = </span><span class="hl-5">function</span><span class="hl-1"> () {</span><br/><span class="hl-1">    </span><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">iterator</span><span class="hl-1">.</span><span class="hl-0">hasPrevious</span><span class="hl-1">()) {</span><br/><span class="hl-1">        </span><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">previousPage</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">iterator</span><span class="hl-1">.</span><span class="hl-0">previous</span><span class="hl-1">();</span><br/><span class="hl-1">        </span><span class="hl-0">showMessagesOnUI</span><span class="hl-1">(</span><span class="hl-4">previousPage</span><span class="hl-1">);</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>
<a id="md:sending-messages" class="tsd-anchor"></a><h3><a href="#md:sending-messages">Sending messages</a></h3><p>The AXP Messaging module supports sending various types of messages, including:</p>
<ul>
<li>Text(Plain text, Emoji&#39;s, Links)</li>
<li>Postback</li>
<li>Reply</li>
<li>Attachment</li>
<li>Location</li>
</ul>
<p>To send a message, use the <code>sendMessage()</code> method on the Conversation. The <code>sendMessage()</code> method takes a <code>SendMessageRequest</code> object as a parameter. Based on the type of message you want to send, you can use one of the following implementations of <code>SendMessageRequest</code> to construct your message:</p>
<ul>
<li><code>SendTextMessage</code>: To send a plain text message.</li>
<li><code>SendMessagePostBackAction</code>: To send a post back message.</li>
<li><code>SendMessageReplyAction</code>: To send a reply message.</li>
<li><code>SendMessageAttachment</code>: To send an attachment message.</li>
<li><code>SendMessageLocation</code>: To send a location message.</li>
</ul>
<a id="md:sending-plaintext-messages" class="tsd-anchor"></a><h4><a href="#md:sending-plaintext-messages">Sending plaintext messages</a></h4><p>To send a plain text message, use the <code>SendTextMessage</code> class to build your message. The <code>SendTextMessage</code> class constructor takes a <code>text</code> and an optional <code>parentMessageId</code> parameter. The <code>parentMessageId</code> is the messageId of the message to which the current message is a reply.</p>
<pre><code class="language-ts"><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">message</span><span class="hl-1"> = </span><span class="hl-5">new</span><span class="hl-1"> </span><span class="hl-0">SendTextMessage</span><span class="hl-1">(</span><span class="hl-2">&#39;Hi&#39;</span><span class="hl-1">);</span><br/><span class="hl-4">conversation</span><span class="hl-1">.</span><span class="hl-0">sendMessage</span><span class="hl-1">(</span><span class="hl-4">message</span><span class="hl-1">);</span>
</code><button>Copy</button></pre>
<a id="md:sending-rich-media-reply-messages" class="tsd-anchor"></a><h4><a href="#md:sending-rich-media-reply-messages">Sending rich media reply messages</a></h4><p>To send a rich media reply message, use the <code>SendMessageReplyAction</code> class to build your message. The <code>SendMessageReplyAction</code> class constructor takes in the action <code>payload</code> of the selected action from the list of actions in the message received from Agent. Along with <code>payload</code>, you can also pass optional arguments <code>actionText</code>, <code>iconUrl</code> and the <code>parentMessageId</code> parameter. Here the <code>parentMessageId</code> can be used to specify the Agent&#39;s reply request rich media message to which this current message is a reply.</p>
<pre><code class="language-ts"><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">message</span><span class="hl-1"> = </span><span class="hl-5">new</span><span class="hl-1"> </span><span class="hl-0">SendMessageReplyAction</span><span class="hl-1">(</span><span class="hl-2">&#39;CUSTOMER_HAPPY&#39;</span><span class="hl-1">, </span><span class="hl-2">&#39;Happy&#39;</span><span class="hl-1">, </span><span class="hl-2">&#39;https://example.com/happy.png&#39;</span><span class="hl-1">, </span><span class="hl-2">&#39;acbc012d-1b73-4e1b-98c9-fe64e7ab2b41&#39;</span><span class="hl-1">);</span><br/><span class="hl-4">conversation</span><span class="hl-1">.</span><span class="hl-0">sendMessage</span><span class="hl-1">(</span><span class="hl-4">message</span><span class="hl-1">);</span>
</code><button>Copy</button></pre>
<a id="md:sending-rich-media-postback-messages" class="tsd-anchor"></a><h4><a href="#md:sending-rich-media-postback-messages">Sending rich media postback messages</a></h4><p>To send a rich media postback message, use the <code>SendMessagePostBackAction</code> class to build your message. The <code>SendMessagePostBackAction</code> class constructor takes in the action <code>payload</code> of the selected action from the list of actions in the message received from Agent. Along with <code>payload</code>, you can also pass optional arguments <code>actionText</code> and the <code>parentMessageId</code> parameter. Here the <code>parentMessageId</code> can be used to specify the Agent&#39;s post back request rich media message to which this current message is a reply.</p>
<pre><code class="language-ts"><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">message</span><span class="hl-1"> = </span><span class="hl-5">new</span><span class="hl-1"> </span><span class="hl-0">SendMessagePostBackAction</span><span class="hl-1">(</span><span class="hl-2">&#39;SHIP_TO_HOME&#39;</span><span class="hl-1">, </span><span class="hl-2">&#39;Ship to home&#39;</span><span class="hl-1">, </span><span class="hl-2">&#39;acbc012d-1b73-4e1b-98c9-fe64e7ab2b41&#39;</span><span class="hl-1">);</span><br/><span class="hl-4">conversation</span><span class="hl-1">.</span><span class="hl-0">sendMessage</span><span class="hl-1">(</span><span class="hl-4">message</span><span class="hl-1">);</span>
</code><button>Copy</button></pre>
<a id="md:sending-location-messages" class="tsd-anchor"></a><h4><a href="#md:sending-location-messages">Sending location messages</a></h4><p>To send a location message, use the <code>SendMessageLocation</code> class to build your message. The <code>SendMessageLocation</code> class constructor takes in the <code>latitude</code>, <code>longitude</code>, and  optional arguments <code>name</code> and <code>address</code>, <code>parentMessageId</code>. The <code>parentMessageId</code> is the messageId of the message to which the current message is a reply.</p>
<p>The <code>name</code> and <code>address</code> are optional parameters that can be used to provide additional information about the location.</p>
<pre><code class="language-ts"><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">message</span><span class="hl-1"> = </span><span class="hl-5">new</span><span class="hl-1"> </span><span class="hl-0">SendMessageLocation</span><span class="hl-1">(</span><span class="hl-9">0</span><span class="hl-1">, </span><span class="hl-9">0</span><span class="hl-1">, </span><span class="hl-2">&#39;North Pole of the Earth&#39;</span><span class="hl-1">, </span><span class="hl-2">&#39;North Pole&#39;</span><span class="hl-1">);</span><br/><span class="hl-4">conversation</span><span class="hl-1">.</span><span class="hl-0">sendMessage</span><span class="hl-1">(</span><span class="hl-4">message</span><span class="hl-1">);</span>
</code><button>Copy</button></pre>
<a id="md:sending-attachment-messages" class="tsd-anchor"></a><h4><a href="#md:sending-attachment-messages">Sending attachment messages</a></h4><p>To send an attachment message, use the <code>SendMessageAttachment</code> class to build your message. The <code>SendMessageAttachment</code> class constructor takes in the <code>File</code> object and optional arguments <code>text</code> (optional text to send along side the file), <code>parentMessageId</code>. The <code>parentMessageId</code> is the messageId of the message to which the current message is a reply. The <code>SendMessageAttachment</code> class can be used to send images as well.</p>
<pre><code class="language-ts"><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">fileInput</span><span class="hl-1"> = </span><span class="hl-4">document</span><span class="hl-1">.</span><span class="hl-0">getElementById</span><span class="hl-1">(</span><span class="hl-2">&#39;file-input&#39;</span><span class="hl-1">)</span><br/><span class="hl-5">let</span><span class="hl-1"> </span><span class="hl-4">selectedFile</span><span class="hl-1">;</span><br/><br/><span class="hl-4">fileInput</span><span class="hl-1">.</span><span class="hl-0">onchange</span><span class="hl-1"> = </span><span class="hl-5">function</span><span class="hl-1"> () {</span><br/><span class="hl-1">    </span><span class="hl-4">selected</span><span class="hl-1"> = </span><span class="hl-4">fileInput</span><span class="hl-1">.</span><span class="hl-4">files</span><span class="hl-1">[</span><span class="hl-9">0</span><span class="hl-1">];</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">sendAttachmentButton</span><span class="hl-1"> = </span><span class="hl-4">document</span><span class="hl-1">.</span><span class="hl-0">getElementById</span><span class="hl-1">(</span><span class="hl-2">&#39;send-attachment-button&#39;</span><span class="hl-1">);</span><br/><br/><span class="hl-4">sendAttachmentButton</span><span class="hl-1">.</span><span class="hl-0">onclick</span><span class="hl-1"> = </span><span class="hl-5">function</span><span class="hl-1"> () {</span><br/><span class="hl-1">    </span><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">message</span><span class="hl-1"> = </span><span class="hl-5">new</span><span class="hl-1"> </span><span class="hl-0">SendMessageAttachment</span><span class="hl-1">(</span><span class="hl-4">selectedFile</span><span class="hl-1">, </span><span class="hl-2">&#39;Here is the invoice&#39;</span><span class="hl-1">, </span><span class="hl-2">&#39;acbc012d-1b73-4e1b-98c9-fe64e7ab2b41&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-4">conversation</span><span class="hl-1">.</span><span class="hl-0">sendMessage</span><span class="hl-1">(</span><span class="hl-4">message</span><span class="hl-1">);</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>
<a id="md:waiting-for-message-to-be-sent" class="tsd-anchor"></a><h3><a href="#md:waiting-for-message-to-be-sent">Waiting for message to be sent</a></h3><p>The <code>sendMessage()</code> API returns a <code>Promise</code> that resolves with the <code>Message</code> object corresponding to the message that sent. This object contains unique <code>messageId</code> of this message and other details.</p>
<a id="md:message-delivery" class="tsd-anchor"></a><h3><a href="#md:message-delivery">Message delivery</a></h3><p>The Client must listen to the the Message Delivered event to be notified when the messages that were sent by the User are delivered to the AXP. To do so the Client use the <code>addMessageDeliveredListener()</code> method on the Conversation object to register the Message Delivered event listener. The <code>addMessageDeliveredListener()</code> method the listener function as the argument. The listener will be called with the Message object corresponding to the message that sent. The Message object contains unique <code>messageId</code> of this message and other details.</p>
<pre><code class="language-ts"><span class="hl-5">function</span><span class="hl-1"> </span><span class="hl-0">showTickOnUI</span><span class="hl-1">(</span><span class="hl-4">message</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-7">// Logic to show tick on UI.</span><br/><span class="hl-1">    </span><span class="hl-7">// ...</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-4">conversation</span><span class="hl-1">.</span><span class="hl-0">addMessageDeliveredListener</span><span class="hl-1">((</span><span class="hl-4">message</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">showTickOnUI</span><span class="hl-1">(</span><span class="hl-4">message</span><span class="hl-1">);</span><br/><span class="hl-1">});</span>
</code><button>Copy</button></pre>
<a id="md:receiving-messages" class="tsd-anchor"></a><h3><a href="#md:receiving-messages">Receiving messages</a></h3><p>The Client must listen to the the Message Arrived event to be notified when the messages are received from the Agent. To do so the Client use the <code>addMessageArrivedListener()</code> method on the Conversation object to register the Message Arrived event listener. The <code>addMessageArrivedListener()</code> method the listener function as the argument. The listener will be called with the Message object corresponding to the message that received. The Message object contains the unique <code>messageId</code> and body of the message sent by the Agent.</p>
<pre><code class="language-ts"><br/><span class="hl-5">function</span><span class="hl-1"> </span><span class="hl-0">showMessagesOnUI</span><span class="hl-1">(</span><span class="hl-4">message</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-7">// Logic to show messages on UI.</span><br/><span class="hl-1">    </span><span class="hl-7">// ...</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-4">conversation</span><span class="hl-1">.</span><span class="hl-0">addMessageArrivedListener</span><span class="hl-1">((</span><span class="hl-4">message</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">showMessagesOnUI</span><span class="hl-1">(</span><span class="hl-4">message</span><span class="hl-1">);</span><br/><span class="hl-1">});</span>
</code><button>Copy</button></pre>
<a id="md:axp-messaging-namespace" class="tsd-anchor"></a><h2><a href="#md:axp-messaging-namespace">Axp Messaging Namespace</a></h2><p>The AXP Messaging module consists of <code>AxpMessaging</code> namespace which contains a set of APIs which aren&#39;t directly coupled to the concept of Messaging Conversation. This namespace consists of APIs and Events related to the networking model used by the AXP Messaging to get messages and events from AXP.</p>
<p>During the session, the state of SDK’s connection with AXP Servers can change. In all the cases the network state changes are notified in the form of events. The Client can subscribe to these events for handling the changes in network.</p>
<p>List of Events:</p>
<table>
<thead>
<tr>
<th>Event Name</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td>Event Stream Connecting</td>
<td>This event is raised when the SDK tries to connect with the event stream.</td>
</tr>
<tr>
<td>Event Stream Connected</td>
<td>This event is raised when the SDK’s connection attempt was successful, and the connection with AXP is established.</td>
</tr>
<tr>
<td>Event Stream Failed</td>
<td>This event is raised when the event stream breaks/fails due to some reason. Details like the reason for failure as well as next retry attempt is provided in the event.</td>
</tr>
<tr>
<td>Event Stream Closed</td>
<td>This event is raised when the SDK disconnects itself from the event stream.</td>
</tr>
</tbody></table>
<p>The Client can use <code>add/remove</code> methods exposed by the <code>AxpMessaging</code> namespace to subscribe/unsubscribe to these events.</p>
<p>Example:</p>
<pre><code class="language-ts"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">AxpMessaging</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&#39;@avaya/axp-client-sdk-messaging&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">AxpMessaging</span><span class="hl-1">.</span><span class="hl-0">addEventStreamConnectingListener</span><span class="hl-1">((</span><span class="hl-4">eventPayload</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-7">// Show connecting on UI.</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-4">AxpMessaging</span><span class="hl-1">.</span><span class="hl-0">addEventStreamConnectedListener</span><span class="hl-1">((</span><span class="hl-4">eventPayload</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-7">// Show connected on UI.</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-4">AxpMessaging</span><span class="hl-1">.</span><span class="hl-0">addEventStreamFailedListener</span><span class="hl-1">((</span><span class="hl-4">eventPayload</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-7">// Show network disconnected on UI.</span><br/><span class="hl-1">    </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`SDK disconnected due to </span><span class="hl-5">${</span><span class="hl-4">eventPayload</span><span class="hl-10">.</span><span class="hl-4">reason</span><span class="hl-5">}</span><span class="hl-2">, next retry attempt will be made after </span><span class="hl-5">${</span><span class="hl-4">eventPayload</span><span class="hl-10">.</span><span class="hl-4">retryAfter</span><span class="hl-5">}</span><span class="hl-2"> seconds.`</span><span class="hl-1">);</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-4">AxpMessaging</span><span class="hl-1">.</span><span class="hl-0">addEventStreamClosedListener</span><span class="hl-1">((</span><span class="hl-4">eventPayload</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-7">// Show connection closed on UI.</span><br/><span class="hl-1">});</span>
</code><button>Copy</button></pre>
<p>After disconnection, the SDK will try to reconnect with AXP until the reconnection window expires. The will try to make multiple attempts to reconnect with AXP. The interval between each subsequent attempt will keep on increasing till the reconnection window (5 minutes) expires. If the SDK is unable to reconnect within the reconnection window, the SDK will stop trying to reconnect.</p>
<p>Post this, the Client can make an explicit attempt to retry connecting with AXP. To do so, the Client must call the <code>retryConnection()</code> method exposed by the <code>AxpMessaging</code> namespace.</p>
<pre><code class="language-ts"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">AxpMessaging</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&#39;@avaya/axp-client-sdk-messaging&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">AxpMessaging</span><span class="hl-1">.</span><span class="hl-0">retryConnection</span><span class="hl-1">();</span>
</code><button>Copy</button></pre>
<p>This method is not an <code>async</code> method and a successful return of this method doesn&#39;t guarantee that the SDK has been connected with AXP yet, instead the Client should subscribe to the Event Stream Connected event. In case of failure during the manual retry attempt, the Client will be notified via the Event Stream Failed event.</p>
<p>If the manual retry is successful, the Client will be notified via the Event Stream Connected event and the SDK will resume its connection with AXP.</p>
<p>Calling <code>retryConnection()</code> method when the SDK is disconnected but within the reconnection window will just reset the delay interval between the subsequent attempts and will attempt to reconnect immediately.</p>
<p>Calling <code>retryConnection()</code> method when the SDK is not disconnected will throw an Error.</p>
</section><section class="tsd-panel-group tsd-index-group"><section class="tsd-panel tsd-index-panel"><h3 class="tsd-index-heading uppercase">Index</h3><section class="tsd-index-section"><h3 class="tsd-index-heading">Namespaces</h3><div class="tsd-index-list"><a href="_avaya_axp_client_sdk_messaging.AxpMessaging.html" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-4"></use></svg><span>Axp<wbr/>Messaging</span></a>
</div></section><section class="tsd-index-section"><h3 class="tsd-index-heading">Enumerations</h3><div class="tsd-index-list"><a href="../enums/_avaya_axp_client_sdk_messaging.ElementType.html" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-8"></use></svg><span>Element<wbr/>Type</span></a>
<a href="../enums/_avaya_axp_client_sdk_messaging.EventStreamFailureReason.html" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-8"></use></svg><span>Event<wbr/>Stream<wbr/>Failure<wbr/>Reason</span></a>
</div></section><section class="tsd-index-section"><h3 class="tsd-index-heading">Classes</h3><div class="tsd-index-list"><a href="../classes/_avaya_axp_client_sdk_messaging.AttachmentMessage.html" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-128"></use></svg><span>Attachment<wbr/>Message</span></a>
<a href="../classes/_avaya_axp_client_sdk_messaging.LocationMessage.html" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-128"></use></svg><span>Location<wbr/>Message</span></a>
<a href="../classes/_avaya_axp_client_sdk_messaging.PostbackMessage.html" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-128"></use></svg><span>Postback<wbr/>Message</span></a>
<a href="../classes/_avaya_axp_client_sdk_messaging.ReplyMessage.html" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-128"></use></svg><span>Reply<wbr/>Message</span></a>
<a href="../classes/_avaya_axp_client_sdk_messaging.TextMessage.html" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-128"></use></svg><span>Text<wbr/>Message</span></a>
</div></section><section class="tsd-index-section"><h3 class="tsd-index-heading">Interfaces</h3><div class="tsd-index-list"><a href="../interfaces/_avaya_axp_client_sdk_messaging.AxpMessagingConversationTrait.html" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-256"></use></svg><span>Axp<wbr/>Messaging<wbr/>Conversation<wbr/>Trait</span></a>
<a href="../interfaces/_avaya_axp_client_sdk_messaging.EventStreamFailed.html" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-256"></use></svg><span>Event<wbr/>Stream<wbr/>Failed</span></a>
<a href="../interfaces/_avaya_axp_client_sdk_messaging.MessageEvent.html" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-256"></use></svg><span>Message<wbr/>Event</span></a>
<a href="../interfaces/_avaya_axp_client_sdk_messaging.MessageRequest.html" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-256"></use></svg><span>Message<wbr/>Request</span></a>
</div></section><section class="tsd-index-section"><h3 class="tsd-index-heading">Type Aliases</h3><div class="tsd-index-list"><a href="../types/_avaya_axp_client_sdk_messaging.Action.html" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-2097152"></use></svg><span>Action</span></a>
<a href="../types/_avaya_axp_client_sdk_messaging.Attachment.html" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-2097152"></use></svg><span>Attachment</span></a>
<a href="../types/_avaya_axp_client_sdk_messaging.ElementText.html" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-2097152"></use></svg><span>Element<wbr/>Text</span></a>
<a href="../types/_avaya_axp_client_sdk_messaging.Item.html" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-2097152"></use></svg><span>Item</span></a>
<a href="../types/_avaya_axp_client_sdk_messaging.LocationCoordinates.html" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-2097152"></use></svg><span>Location<wbr/>Coordinates</span></a>
<a href="../types/_avaya_axp_client_sdk_messaging.LocationDetails.html" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-2097152"></use></svg><span>Location<wbr/>Details</span></a>
<a href="../types/_avaya_axp_client_sdk_messaging.Message.html" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-2097152"></use></svg><span>Message</span></a>
</div></section><section class="tsd-index-section"><h3 class="tsd-index-heading">Functions</h3><div class="tsd-index-list"><a href="../functions/_avaya_axp_client_sdk_messaging.AxpMessagingConversation.html" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-64"></use></svg><span>Axp<wbr/>Messaging<wbr/>Conversation</span></a>
</div></section></section></section></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-index-accordion"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><h4 class="uppercase">Member Visibility</h4><form><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-private" name="private"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Private</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></form></div><div class="tsd-theme-toggle"><h4 class="uppercase">Theme</h4><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-index-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#md:axp-messaging"><span>AXP <wbr/>Messaging</span></a><ul><li><a href="#md:main-features"><span>Main features</span></a></li><li><a href="#md:installation"><span>Installation</span></a></li><li><a href="#md:usage"><span>Usage</span></a></li><li><a href="#md:messaging-conversation"><span>Messaging <wbr/>Conversation</span></a></li><li><ul><li><a href="#md:getting-conversation-history"><span>Getting conversation history</span></a></li><li><a href="#md:sending-messages"><span>Sending messages</span></a></li><li><ul><li><a href="#md:sending-plaintext-messages"><span>Sending plaintext messages</span></a></li><li><a href="#md:sending-rich-media-reply-messages"><span>Sending rich media reply messages</span></a></li><li><a href="#md:sending-rich-media-postback-messages"><span>Sending rich media postback messages</span></a></li><li><a href="#md:sending-location-messages"><span>Sending location messages</span></a></li><li><a href="#md:sending-attachment-messages"><span>Sending attachment messages</span></a></li></ul></li><li><a href="#md:waiting-for-message-to-be-sent"><span>Waiting for message to be sent</span></a></li><li><a href="#md:message-delivery"><span>Message delivery</span></a></li><li><a href="#md:receiving-messages"><span>Receiving messages</span></a></li></ul></li><li><a href="#md:axp-messaging-namespace"><span>Axp <wbr/>Messaging <wbr/>Namespace</span></a></li></ul></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="../index.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-1"></use></svg><span>AXP Web Omni SDK</span></a><ul class="tsd-small-nested-navigation" id="tsd-nav-container" data-base=".."><li>Loading...</li></ul></nav></div></div></div><div class="overlay"></div></body></html>